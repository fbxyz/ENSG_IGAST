---
title: "Cours MAUP M2 IGAST"
output:
  html_document:
    toc: true
    theme: united
---


# 1 - Objectifs du TD

Ce TD a pour objectif de sensibiliser les Ã©tudiants au MAUP et Ã  ses implications pour l'analyse spatiale.

Il permettra aux Ã©tudiants de comprendre comment le choix des unitÃ©s spatiales peut influencer les rÃ©sultats de l'analyse et d'apprendre Ã  identifier et Ã  attÃ©nuer les effets du MAUP.

------------------------------------------------------------------------

# 2 - DÃ©finition et exemples

## 2.1 DÃ©finition

Le MAUP (Modifiable Areal Unit Problem) est un biais statistique qui peut influencer les rÃ©sultats des tests d'hypothÃ¨ses statistiques.

Il survient lorsque des mesures ponctuelles de phÃ©nomÃ¨nes spatiaux sont agrÃ©gÃ©es en unitÃ©s spatiales (comme des rÃ©gions ou des maillages abstraits) pour calculer des valeurs rÃ©sumÃ©es telles que des totaux, des taux, des proportions ou des densitÃ©s. Ces valeurs sont influencÃ©es Ã  la fois par la forme et par l'Ã©chelle de l'unitÃ© d'agrÃ©gation.

-   En d'autres termes, les conclusions que vous tirez de l'analyse de donnÃ©es spatiales peuvent varier en fonction de la taille, de la forme et de la configuration des unitÃ©s gÃ©ographiques que vous utilisez.

-   Ce problÃ¨me est crucial car il peut conduire Ã  des interprÃ©tations erronÃ©es des donnÃ©es et Ã  des conclusions inexactes.

### 2.1.1 - InterprÃ©tations erronÃ©es

Le MAUP peut conduire Ã  des interprÃ©tations erronÃ©es des donnÃ©es et Ã  des conclusions inexactes. Les rÃ©sultats d'une analyse peuvent varier considÃ©rablement en fonction de la maniÃ¨re dont les donnÃ©es sont agrÃ©gÃ©es gÃ©ographiquement.

### 2.1.2 - Biais dans les Ã©tudes spatiales

Le MAUP est une source d'erreur critique dans les Ã©tudes spatiales, qu'elles soient observationnelles ou expÃ©rimentales. Il peut masquer une forte corrÃ©lation entre les variables ou, Ã  l'inverse, faire apparaÃ®tre une association significative lÃ  oÃ¹ il n'y en a pas.

### 2.1.3 - DifficultÃ© de gÃ©nÃ©ralisation

Les rÃ©sultats obtenus Ã  partir d'une zone gÃ©ographique particuliÃ¨re ne peuvent pas Ãªtre gÃ©nÃ©ralisÃ©s Ã  d'autres zones avec des limites diffÃ©rentes.

### 2.1.4 - Impact sur les rÃ©sultats

Les dÃ©cisions basÃ©es sur des donnÃ©es agrÃ©gÃ©es peuvent Ãªtre biaisÃ©es par le MAUP, ce qui peut avoir des consÃ©quences importantes sur les politiques publiques, notamment en matiÃ¨re de santÃ©, d'amÃ©nagement du territoire ou de transport.

## 2.2 - Effet de zonage et l'effet d'Ã©chelle

Le MAUP survient lorsque les rÃ©sultats de l'analyse sont influencÃ©s par la maniÃ¨re dont les donnÃ©es sont agrÃ©gÃ©es gÃ©ographiquement. Il se manifeste par deux effets principaux : **l'effet de zonage** et **l'effet d'Ã©chelle**.

### 2.2.1 - Effet de zonage :

L'effet de zonage dÃ©crit la variation des statistiques causÃ©e par le regroupement des donnÃ©es en diffÃ©rentes configurations Ã  la mÃªme Ã©chelle. Il s'agit de la forme des unitÃ©s spatiales qui est modifiÃ©e, tout en gardant une superficie constante.

Par exemple, si l'on divise un territoire en zones de formes diffÃ©rentes (carrÃ©es, rectangulaires, circulaires), les rÃ©sultats d'une analyse statistique portant sur la densitÃ© de population ou le taux de criminalitÃ© peuvent varier considÃ©rablement, mÃªme si la superficie totale de chaque zone est la mÃªme.

![](~/florian/Dropbox/Fac/ENSG/ENSG_IGAST/assets/images/MAUP_point_grid.png)

![](~/florian/Dropbox/Fac/ENSG/ENSG_IGAST/assets/images/MAUP_point_grid_agg.png)

### 2.2.2 - Effet d'Ã©chelle :

L'effet d'Ã©chelle provoque une variation des rÃ©sultats statistiques entre diffÃ©rents niveaux d'agrÃ©gation.

Il s'agit du niveau d'agrÃ©gation qui est modifiÃ©, ce qui implique une modification de la superficie des unitÃ©s spatiales.

### 2.2.3 - Exemple de l'effet de zonage et de l'effet d'Ã©chelle

![](~/florian/Dropbox/Fac/ENSG/ENSG_IGAST/assets/images/MAUP_exemple.png)

A noter que le MAUP va aussi avoir des effets sur vos analyses de corrÃ©lation : cette derniÃ¨re tend Ã  augmenter Ã  mesure que la taille de l'unitÃ© spatiale augmente.

## 2.3 : Exemple Ã  partir d'un tableau

|               | EmployÃ©s | ChÃ´meurs | Total | (ChÃ´meurs %) |
|---------------|----------|----------|-------|--------------|
| **Zone A**    |          |          |       |              |
| Jeunes        | 81       | 9        | 90    | (10%)        |
| Vieux         | 9        | 1        | 10    | (10%)        |
| **Total**     | 90       | 10       | 100   | (10%)        |
| **Zone B**    |          |          |       |              |
| Jeunes        | 40       | 10       | 50    | (20%)        |
| Vieux         | 40       | 10       | 50    | (20%)        |
| **Zones A+B** | 80       | 20       | 100   | (20%)        |
| Jeunes        | 121      | 19       | 140   | (13.6%)      |
| Vieux         | 49       | 11       | 60    | (18.3%)      |
| ***Total***   | *170*    | *30*     | *200* | *(15%)*      |

------------------------------------------------------------------------

### 2.3.1 - Observations :

-   Les zones A et B ont chacune une population totale de 100 personnes.
-   Dans la zone A, 10% de jeunes et 10% de vieux sont au chÃ´mage.
-   Dans la zone B, 20% de jeunes et 20% de vieux sont au chÃ´mage.

### 2.3.2 - Biais :

Si l'on combine les zones A et B, on pourrait s'attendre Ã  ce que le taux de chÃ´mage global soit de 15% pour les deux groupes. Cependant, ce n'est pas le cas.

-   Le taux de chÃ´mage combinÃ© pour les jeunes est de 13,6%.
-   Le taux de chÃ´mage combinÃ© pour les vieux est de 18,3%.

### Explication du biais :

Ce rÃ©sultat inattendu est dÃ» Ã  la diffÃ©rence de la taille des populations de chaque groupe ethnique dans les zones A et B.

-   La zone A a une population jeunes beaucoup plus importante que la population Ã¢gÃ©e.
-   La zone B a des populations jeunes et Ã¢gÃ©es Ã©gales.

En combinant les zones, le taux de chÃ´mage global est davantage influencÃ© par la zone A, qui a une population jeune plus importante. Cela crÃ©e un biais qui donne l'impression que le taux de chÃ´mage est plus faible pour les jeunes que pour les vieux

Cet exemple illustre l'effet d'Ã©chelle du MAUP : le choix de l'unitÃ© spatiale d'agrÃ©gation (zone A, zone B ou A+B) a un impact direct sur les statistiques calculÃ©es et peut conduire Ã  des conclusions erronÃ©es.

## 2.4 - Exemple : le Gerrymandering

Le Gerrymandering est une pratique qui consiste Ã  manipuler les frontiÃ¨res des circonscriptions Ã©lectorales afin de favoriser un parti politique ou un groupe particulier.

Cette manipulation peut prendre diffÃ©rentes formes, notamment: - Concentrer les Ã©lecteurs d'un parti adverse dans un petit nombre de districts afin de rÃ©duire leur influence dans les autres districts. - Disperser les Ã©lecteurs d'un parti adverse dans plusieurs districts afin de les empÃªcher d'obtenir une majoritÃ© dans aucun d'entre eux. - CrÃ©er des districts de formes bizarres et non compactes pour regrouper les Ã©lecteurs favorables Ã  un parti donnÃ©.

### 2.4.1 - Dans le principe :

![](~/florian/Dropbox/Fac/ENSG/ENSG_IGAST/assets/images/MAUP_gerry.png "How to steal an election")

### 2.4.2 - Dans la rÃ©alitÃ© :

> `ğŸ“` Que constatez-vous dans cet exemple sur le Wisconsin ?

![](~/florian/Dropbox/Fac/ENSG/ENSG_IGAST/assets/images/MAUP_wisconsin.png "How to steal an election")

# 3 - ComprÃ©hension du phÃ©nomÃ¨ne

Nous allons maintenant illustrer le phÃ©nomÃ¨ne du MAUP en reprenant le jeu de donnÃ©es sur le taux de boisement en France

## 3.1 - Chargement et structures des donnÃ©es

### Commune : *com_foret*

> `ğŸ“` Chargez les donnÃ©es pour les communes dans un dataframe *com_foret*
>
> `ğŸ“` Calculez le taux de boisement dans une nouvelle colonne *txbois* du dataframe

```{r}
library(sf)

# Chemin vers les donnÃ©es EPCI
url_com <- "https://github.com/fbxyz/ENSG_IGAST/raw/master/data/MAUP_COM_FORET_3857.geojson" 
url_com <- "./data/MAUP_COM_FORET_3857.geojson"

# Charger le fichier GeoJSON des EPCI
com_foret <- st_read(url_com)
com_foret <- st_transform(com_foret, crs = 2154)

# Calcul du taux de boisement 
com_foret$txbois <- round(com_foret$surface_foret / com_foret$surface_com *100,1)

# Afficher la structure des donnÃ©es
str(com_foret)

```

### EPCI : *epci_foret*

> `ğŸ“` Chargez les donnÃ©es pour les EPCI dans un dataframe *epci_foret*
>
> `ğŸ“` Calculez le taux de boisement dans une nouvelle colonne *txbois* du dataframe

```{r}
library(sf)

# Chemin vers les donnÃ©es EPCI
url_epci <- "https://github.com/fbxyz/ENSG_IGAST/raw/master/data/MAUP_EPCI_FORET_3857.geojson" 
url_epci <- "./data/MAUP_EPCI_FORET_3857.geojson"

# Charger le fichier GeoJSON des EPCI
epci_foret <- st_read(url_epci)
epci_foret <- st_transform(epci_foret, crs = 2154)

# Calcul du taux de boisement 
epci_foret$txbois <- round(epci_foret$surface_foret / epci_foret$surface_epci *100,1)

# Afficher la structure des donnÃ©essurface_epcisurface_epci
str(epci_foret)

```

### DÃ©partements : dep_foret

> `ğŸ“` Chargez les donnÃ©es pour les dÃ©partements dans un dataframe *dep_foret*
>
> `ğŸ“` Calculez le taux de boisement dans une nouvelle colonne *txbois* du dataframe

```{r}

# Chemin vers les donnÃ©es des dÃ©partements
url_dep <- "https://github.com/fbxyz/ENSG_IGAST/raw/master/data/MAUP_DEP_FORET_3857.geojson"
url_dep <- "./data/MAUP_DEP_FORET_3857.geojson"

# Charger le fichier GeoJSON des dÃ©partements
dep_foret <- st_read(url_dep)
dep_foret <- st_transform(dep_foret, crs = 2154)

# Calcul du taux de boisement 
dep_foret$txbois <- round(dep_foret$surface_foret / dep_foret$surface_dept *100,1)

# Afficher la structure des donnÃ©es
str(dep_foret)

```

### Anciennes rÃ©gions

> `ğŸ“` Chargez les donnÃ©es pour les anciennes rÃ©gions dans un dataframe *oldreg_foret*
>
> `ğŸ“` Calculez le taux de boisement dans une nouvelle colonne *txbois* du dataframe

```{r}

# Chemin vers les donnÃ©es des anciennes rÃ©gions
url_oldreg <- "https://github.com/fbxyz/ENSG_IGAST/raw/master/data/MAUP_OLDREG_FORET_3857.geojson"
url_oldreg <- "./data/MAUP_OLDREG_FORET_3857.geojson"

# Charger le fichier GeoJSON
oldreg_foret <- st_read(url_oldreg)
oldreg_foret <- st_transform(oldreg_foret, crs = 2154)

# Calcul du taux de boisement 
oldreg_foret$txbois <- round(oldreg_foret$surface_foret / oldreg_foret$surface_oldreg *100,1)

# Afficher la structure des donnÃ©es
str(oldreg_foret)

```

### Nouvelles rÃ©gions

> `ğŸ“` Chargez les donnÃ©es pour les anciennes rÃ©gions dans un dataframe *oldreg_foret*
>
> `ğŸ“` Calculez le taux de boisement dans une nouvelle colonne *txbois* du dataframe

```{r}

# Chemin vers les donnÃ©es des nouvlles rÃ©gions
url_reg <- "https://github.com/fbxyz/ENSG_IGAST/raw/master/data/MAUP_REG_FORET_3857.geojson"
url_reg <- "./data/MAUP_REG_FORET_3857.geojson"

# Charger le fichier GeoJSON
reg_foret <- st_read(url_reg)
reg_foret <- st_transform(reg_foret, crs = 2154)

# Calcul du taux de boisement 
reg_foret$txbois <- round(reg_foret$surface_foret / reg_foret$surface_reg *100,1)

# Afficher la structure des donnÃ©es
str(reg_foret)

```

## 3.2 - Cartographie des donnÃ©es

Pour illustrer les diffÃ©rents effets du MAUP, vous allez cartographier le mÃªme taux de boisement en France, mais Ã  diffÃ©rents maillages.

La premiÃ¨re carte Ã  la commune est montrÃ©e en exemple

### Carte par communes

```{r}
# Charger le package mapsf pour la crÃ©ation des cartes
library(mapsf)

mf_theme("dark")
mf_shadow(com_foret, col = "grey50", cex = 0.3)

# CrÃ©er un fond pour la carte en utilisant la fonction mf_map()
mf_map(x = com_foret, 
       var = "txbois", 
       type = "choro",
       breaks = "fisher",
       nbreaks = 5,
       leg_pos = "left",
       leg_title = "Taux de boisement\n(en %)",
       leg_val_rnd = 1,
       border = "grey30",
       lwd = 0.2,
       #expandBB = c(0, -0.3, 0, -0.6),
       add = TRUE
       )

mf_title("Taux de boisement par commune en 2024")
mf_credits("Source: IGN, 2024")

```

### Carte par EPCI

> `ğŸ“` En vous aidant de l'exemple prÃ©cÃ©dent, cartographiez le taux de boisement pour les EPCI, les dÃ©partements, les anciennes rÃ©gions et les nouvelles rÃ©gions.

> `ğŸ“` Appliquez vos connaissances sur la discrÃ©tisation pour rendre les cartes comparables

> `ğŸ“` Consultez l'aide de mapsf si besoin : <https://riatelab.github.io/mapsf/reference/mf_get_breaks.html>

> `ğŸ“` Quâ€™observez-vous sur la rÃ©partition du taux de boisement Ã  diffÃ©rentes Ã©chelles dâ€™agrÃ©gation ?

```{r}
# Charger le package mapsf pour la crÃ©ation des cartes
library(mapsf)

mf_theme("dark")
mf_shadow(epci_foret, col = "grey50", cex = 0.3)

# CrÃ©er un fond pour la carte en utilisant la fonction mf_map()
mf_map(x = epci_foret, 
       var = "txbois", 
       type = "choro",
       breaks = "fisher",
       nbreaks = 5,
       leg_pos = "left",
       leg_title = "Taux de boisement\n(en %)",
       leg_val_rnd = 1,
       border = "grey30",
       lwd = 0.2,
       #expandBB = c(0, -0.3, 0, -0.6),
       add = TRUE
       )

mf_title("Taux de boisement par EPCI en 2024")
mf_credits("Source: IGN, 2024")

```

### Carte par DÃ©partements

```{r}

mf_theme("dark")
mf_shadow(dep_foret, col = "grey50", cex = 0.3)

# CrÃ©er un fond pour la carte en utilisant la fonction mf_map()
mf_map(x = dep_foret, 
       var = "txbois", 
       type = "choro",
       breaks = "fisher",
       nbreaks = 5,
       leg_pos = "left",
       leg_title = "Taux de boisement\n(en %)",
       leg_val_rnd = 1,
       border = "grey30",
       lwd = 0.2,
       #expandBB = c(0, -0.3, 0, -0.6),
       add = TRUE
       )

mf_title("Taux de boisement par dÃ©partements en 2024")
mf_credits("Source: IGN, 2024")

```

### Carte par Anciennes rÃ©gions

```{r}
mf_theme("dark")
mf_shadow(oldreg_foret, col = "grey50", cex = 0.3)

# CrÃ©er un fond pour la carte en utilisant la fonction mf_map()
mf_map(x = oldreg_foret, 
       var = "txbois", 
       type = "choro",
       breaks = "fisher",
       nbreaks = 5,
       leg_pos = "left",
       leg_title = "Taux de boisement\n(en %)",
       leg_val_rnd = 1,
       border = "grey30",
       lwd = 0.2,
       #expandBB = c(0, -0.3, 0, -0.6),
       add = TRUE
       )

mf_title("Taux de boisement par anciennes rÃ©gions en 2024")
mf_credits("Source: IGN, 2024")
```

### Carte par Nouvelles rÃ©gions

```{r}
mf_theme("dark")
mf_shadow(reg_foret, col = "grey50", cex = 0.3)

# CrÃ©er un fond pour la carte en utilisant la fonction mf_map()
mf_map(x = reg_foret, 
       var = "txbois", 
       type = "choro",
       breaks = "fisher",
       nbreaks = 5,
       leg_pos = "left",
       leg_title = "Taux de boisement\n(en %)",
       leg_val_rnd = 1,
       border = "grey30",
       lwd = 0.2,
       #expandBB = c(0, -0.3, 0, -0.6),
       add = TRUE
       )

mf_title("Taux de boisement par rÃ©gions en 2024")
mf_credits("Source: IGN, 2024")
```

## 3.3 Analyse univariÃ©e

En utilisant les acquis des cours prÃ©cÃ©dents, rÃ©aliser l'analyse univariÃ©e du taux de boisement pour chaque maillage

> `ğŸ“` Calculez les valeurs centrales et les paramÃ¨tres de dispersion

> `ğŸ“` Des boxplots pourraient s'avÃ©rer utiles

> `ğŸ“` Que constatez-vous ?


### EPCI

```{r}

summary(epci_foret$txbois)

sd(epci_foret$txbois)

boxplot(epci_foret$txbois, 
        main = "Taux de boisement par EPCI", 
        ylab = "Taux de boisement (%)")

```

### DÃ©partements

```{r}

```

### Anciennes rÃ©gions

```{r}

```

### Nouvelles rÃ©gions

```{r}

```

### Comparaisons

```{r}
# Charger les donnÃ©es en format long avec `stack` 
df_txbois_long <- stack(list(
  Communes = com_foret$txbois,
  EPCI = epci_foret$txbois,
  Departements = dep_foret$txbois,
  Anciennes_regions = oldreg_foret$txbois,
  Nouvelles_regions = reg_foret$txbois
))

# Renommer les colonnes pour plus de clartÃ©
colnames(df_txbois_long) <- c("txbois", "Maillage")

# Calculer les valeurs centrales pour chaque maillage
mean_vals <- tapply(df_txbois_long$txbois, df_txbois_long$Maillage, mean, na.rm = TRUE)
median_vals <- tapply(df_txbois_long$txbois, df_txbois_long$Maillage, median, na.rm = TRUE)
sd_vals <- tapply(df_txbois_long$txbois, df_txbois_long$Maillage, sd, na.rm = TRUE)

# CrÃ©er un dataframe pour rÃ©sumer les valeurs centrales
df_summary <- data.frame(
  Maillage = names(mean_vals),
  Moyenne = mean_vals,
  Mediane = median_vals,
  Ecart_type = sd_vals
)

print(df_summary)
```

Boxplots
```{r}
# CrÃ©er les boxplots avec ggplot2

library(ggplot2)

ggplot(df_txbois_long, aes(x = Maillage, y = txbois, fill = Maillage)) +
  geom_boxplot() +
  labs(
    title = "Comparaison du taux de boisement selon le maillage",
    x = "Maillage",
    y = "Taux de boisement (%)"
  ) +
  theme_minimal() +
  theme(legend.position = "none") 

```


Scatter
```{r}

com_foret_df <- st_drop_geometry(com_foret)

taux_boisement_dept <- com_foret_df %>%
  dplyr::group_by(insee_dep) %>%
  dplyr::summarise(txbois_moyen = mean(txbois, na.rm = TRUE))

communes <- com_foret_df %>%
  dplyr::left_join(taux_boisement_dept, by = "insee_dep")

ggplot(communes, aes(x = txbois, y = txbois_moyen)) +
  geom_point(alpha = 0.5) +
  labs(
    title = "Comparaison des taux de boisement entre Ã©chelles communale et dÃ©partementale",
    x = "Taux de boisement - Ã‰chelle communale",
    y = "Taux de boisement - Ã‰chelle dÃ©partementale"
  ) 

```

### Correction :

-   des variations dans les valeurs centrales : Les moyennes et mÃ©dianes du taux de boisement peuvent diffÃ©rer selon le maillage utilisÃ©, illustrant l'influence du choix de l'unitÃ© spatiale sur les statistiques descriptives.

-   Une diminution de la dispersion avec l'augmentation de l'Ã©chelle : Les Ã©carts-types et l'Ã©tendue des boxplots seront gÃ©nÃ©ralement plus importants pour les maillages fins (EPCI) et diminueront progressivement avec l'augmentation de l'Ã©chelle (Nouvelles rÃ©gions). Cela s'explique par le phÃ©nomÃ¨ne d'agrÃ©gation : en regroupant les donnÃ©es sur des zones plus vastes, on lisse les variations locales.

## 3.4 - AggrÃ©gation des rÃ©sultats Ã  partir des diffÃ©rents maillage

> `ğŸ“` A partir de *com_foret*, reconstruisez le maillage aux nouvelles rÃ©gions.

> `ğŸ“` Lors du regroupement, faites la **somme** des surfaces et la \*\*moyenne\* de txbois

> `ğŸ“` PrivilÃ©giez l'utilisation de dplyr. Supprimez la gÃ©omÃ©trie de *com_foret* avec : com_foret_df <- st_drop_geometry(com_foret)

> `ğŸ“` Recalculez *txbois* Ã  partir de la somme des surfaces de forÃªts dans chaque rÃ©gion et de la superficie des rÃ©gions

> `ğŸ“` Que constatez-vous ?

```{r}

library(dplyr)


# Conversion de sf Ã  data.frame sans gÃ©omÃ©trie
com_foret_df <- st_drop_geometry(com_foret)

# AgrÃ©gation des donnÃ©es par rÃ©gion (insee_reg)
reg_foret_reconstruit <- com_foret_df %>%
  group_by(code = insee_reg) %>%
  summarise(
    surface_reg = sum(surface_com, na.rm = TRUE),
    surface_foret = sum(surface_foret, na.rm = TRUE),
    txbois_moyen = mean(txbois, na.rm = TRUE)
  )

reg_foret_reconstruit$txbois <- round(reg_foret_reconstruit$surface_foret / reg_foret_reconstruit$surface_reg *100,1)

reg_foret_reconstruit
```

------------------------------------------------------------------------

# 4 - Pour aller plus loin

## Quelles solutions pour limiter les effets du MAUP ?

Le MAUP est un dÃ©fi majeur en analyse spatiale, mais il existe plusieurs approches pour tenter de minimiser son influence et obtenir des rÃ©sultats plus robustes.

### Faire prendre conscience du problÃ¨me

La premiÃ¨re Ã©tape pour minimiser l'impact du MAUP est de sensibiliser les utilisateurs aux dangers potentiels de l'agrÃ©gation spatiale des donnÃ©es. Il est essentiel de comprendre que le choix des unitÃ©s spatiales peut influencer significativement les rÃ©sultats d'une analyse.

### Utilisation de donnÃ©es Ã  l'Ã©chelle la plus fine possible

Si possible, utiliser des donnÃ©es Ã  l'Ã©chelle la plus fine possible, pour minimiser l'impact du MAUP. Cette approche permet d'Ã©viter l'agrÃ©gation des donnÃ©es et de conserver la prÃ©cision spatiale.

Elle pose nÃ©anmoins un problÃ¨me majeur : avec des maillages de petites tailles, la puissance statistique peut Ãªtre insuffisante ou bien poser des problÃ¨mes de confidentialitÃ©

### Analyse de sensibilitÃ© du MAUP

L'analyse de sensibilitÃ© du MAUP est une approche importante pour Ã©valuer l'impact du choix des unitÃ©s spatiales sur les rÃ©sultats de l'analyse.

Elle consiste Ã  effectuer des analyses avec diffÃ©rentes configurations d'unitÃ©s spatiales et Ã  comparer les rÃ©sultats pour identifier les zones de sensibilitÃ©. Le rapport de variance permet d'Ã©tudier l'effet de la configuration spatiale, de l'association spatiale et de l'agrÃ©gation des donnÃ©es.

### RÃ©gression

Dans le cas oÃ¹ vous appliquez une rÃ©gression linÃ©aire / multiple sur une zone d'Ã©tude, vous pouvez rÃ©duire les biais du MAUP

-   En utilisant une rÃ©gression spatiale pondÃ©rÃ©e
-   En utilisant des modÃ¨les hiÃ©rarchiques bayÃ©siens. Ils permettent de combiner des donnÃ©es agrÃ©gÃ©es et des donnÃ©es individuelles pour l'infÃ©rence Ã©cologique. Cette approche permet de tenir compte de la structure hiÃ©rarchique des donnÃ©es spatiales et de modÃ©liser les relations entre les variables Ã  diffÃ©rents niveaux d'agrÃ©gation.

### Lissage spatial et gÃ©ographique

Le lissage spatial et le lissage gÃ©ographique sont des techniques qui peuvent Ãªtre utilisÃ©es pour attÃ©nuer les effets du MAUP en analyse spatiale.

Le **lissage spatial** est une mÃ©thode d'estimation non paramÃ©trique de la fonction d'intensitÃ© de donnÃ©es ponctuelles.

-   Il permet de rÃ©vÃ©ler des structures spatiales sous-jacentes en filtrant l'information.
-   Il s'agit d'une modÃ©lisation locale qui repose sur le choix d'un kernel et d'une bandwith.
-   Le kernel dÃ©crit la faÃ§on dont le voisinage est apprÃ©hendÃ© (type de fonction Ã  l'intÃ©rieur de la fenÃªtre),
-   tandis que la bandwith quantifie la Â« taille Â» du voisinage.
-   Le choix de la bandwith est un arbitrage entre la prÃ©cision spatiale de l'analyse et sa qualitÃ© statistique (compromis biais-variance).

Dans cet exemple, les mÃ©decins gÃ©nÃ©ralistes sont gÃ©ocodÃ©s Ã  l'adresse exacte. Ils auraient pu Ãªtre localisÃ©s dans un maillage, mais il est prÃ©fÃ©rable d'avoir leur localisation exacte Ã  cette Ã©chelle.

![](~/florian/Dropbox/Fac/ENSG/ENSG_IGAST/assets/images/MAUP_point_gp.png)

Sur la zone d'Ã©tude, on applique un Kernel Density Estimator (KDE) de bandwith 200m et avec une fonction gaussienne dans le kernel.

![](~/florian/Dropbox/Fac/ENSG/ENSG_IGAST/assets/images/MAUP_kde_gp.png "Two dimensionals KDE with an estimator bandwidth of 0.2")

Le **lissage gÃ©ographique** s'inspire du lissage spatial pour obtenir des reprÃ©sentations cartographiques simplifiÃ©es.

-   Il consiste Ã  remplacer la valeur observÃ©e en un point par une moyenne pondÃ©rÃ©e des valeurs observÃ©es au voisinage de ce point dans un rayon prÃ©dÃ©fini.
-   Il faut utiliser une matrice de voisinage d'ordre n. Les donnÃ©es sont gÃ©nÃ©ralement pondÃ©rÃ©es en fonction Ã  l'inverse de l'ordre.
-   La fonction de pondÃ©ration dÃ©pendante de l'ordre se comporte comme un paramÃ¨tre de lissage, contrÃ´lant l'Ã©quilibre entre biais et variance.

#### Avantages du lissage spatial et gÃ©ographique :

-   S'affranchir de l'arbitraire des dÃ©coupages territoriaux.
-   Limiter les effets de bord.
-   RÃ©vÃ©ler des variations locales Ã  diffÃ©rentes Ã©chelles.
-   Assurer une forme de confidentialitÃ©.

#### Points Ã  prendre en compte :

Choix de la bande passante :

-   Le choix de la bande passante est crucial, car il influence la prÃ©cision et la variance des estimations.
-   Il n'existe pas de bande passante optimale unique, et il est conseillÃ© de tester plusieurs valeurs pour rÃ©vÃ©ler les diffÃ©rents aspects spatiaux du phÃ©nomÃ¨ne Ã©tudiÃ©.

Effets de bord :

-   Les effets de bord peuvent influencer les estimations, en particulier Ã  proximitÃ© des frontiÃ¨res de la zone d'Ã©tude.
-   DiffÃ©rentes corrections existent pour prendre en compte les effets de bord, comme la correction uniforme et la correction de Diggle.

InterprÃ©tation des rÃ©sultats :

-   Les mÃ©thodes de lissage attÃ©nuent les ruptures et les frontiÃ¨res, induisant des reprÃ©sentations continues des phÃ©nomÃ¨nes gÃ©ographiques. - Il est important de commenter uniquement des phÃ©nomÃ¨nes dont l'ordre de grandeur est trÃ¨s supÃ©rieur au rayon de lissage.

------------------------------------------------------------------------

# Conclusion

Le MAUP, comme nous l'avons vu tout au long de ce TD, reprÃ©sente un dÃ©fi majeur en analyse spatiale. Il est crucial de retenir que le choix des unitÃ©s spatiales, leur forme et leur taille, peuvent influencer de maniÃ¨re significative les rÃ©sultats de nos analyses. Les exemples du taux de boisement en France et de l'analyse du chÃ´mage par groupe ethnique ont clairement illustrÃ© comment des conclusions diffÃ©rentes peuvent Ãªtre tirÃ©es d'un mÃªme jeu de donnÃ©es, simplement en modifiant l'Ã©chelle gÃ©ographique d'analyse.

Face Ã  ce constat, il est essentiel de mettre en place des stratÃ©gies pour minimiser l'impact du MAUP sur nos analyses. L'utilisation de donnÃ©es Ã  l'Ã©chelle la plus fine possible, la rÃ©alisation d'analyses de sensibilitÃ© avec diffÃ©rentes configurations spatiales, et l'utilisation de techniques de rÃ©gression spatiale, comme la rÃ©gression spatiale pondÃ©rÃ©e ou les modÃ¨les hiÃ©rarchiques bayÃ©siens, sont autant d'outils Ã  notre disposition

Il n'existe donc pas de solution unique pour rÃ©soudre complÃ¨tement le MAUP. La meilleure approche dÃ©pend de la question de recherche, des donnÃ©es disponibles et des objectifs de l'analyse. Il est important de combiner diffÃ©rentes mÃ©thodes et d'effectuer des analyses de sensibilitÃ© pour Ã©valuer l'impact du MAUP et obtenir des rÃ©sultats robustes.

En outre, une transparence mÃ©thodologique rigoureuse est indispensable pour garantir la validitÃ© et la reproductibilitÃ© des analyses spatiales. La documentation prÃ©cise des Ã©chelles gÃ©ographiques utilisÃ©es et la discussion ouverte sur l'impact potentiel du MAUP sur les rÃ©sultats sont des Ã©lÃ©ments essentiels pour une communication scientifique.

Ce TD a permis de mettre en lumiÃ¨re l'importance capitale de la prise de conscience du MAUP et de ses implications dans toute analyse spatiale. Il est crucial de comprendre que le choix des unitÃ©s spatiales peut biaiser nos rÃ©sultats. L'adoption d'une approche mÃ©thodologique rigoureuse, combinant des donnÃ©es fines, des analyses de sensibilitÃ© et des techniques statistiques adaptÃ©es, est indispensable pour limiter ces biais et produire des conclusions robustes

# Bibliographie

## Ouvrages de RÃ©fÃ©rence sur le MAUP

```         
Openshaw, S. (1984). The Modifiable Areal Unit Problem. Geo Books, Norwich.
    Ouvrage fondateur qui explore en profondeur le MAUP, ses implications et ses effets sur les analyses spatiales.

Fotheringham, A. S., & Wong, D. W. S. (1991). "The Modifiable Areal Unit Problem in Multivariate Statistical Analysis". Environment and Planning A, 23(7), 1025-1044.
    Article clÃ© qui Ã©tudie le MAUP dans le contexte d'analyses multivariÃ©es, avec des exemples de l'impact du MAUP.
```

## Analyses Spatiales et Statistiques de lissage

```         
Bailey, T. C., & Gatrell, A. C. (1995). Interactive Spatial Data Analysis. Longman, Essex.
    RÃ©fÃ©rence pour les techniques de lissage et les statistiques spatiales appliquÃ©es, incluant des mÃ©thodes de lissage gÃ©ographique et de calcul de densitÃ© spatiale.

Silverman, B. W. (1986). Density Estimation for Statistics and Data Analysis. Chapman and Hall, London.
    Ouvrage de base sur l'estimation de densitÃ©, qui dÃ©crit les mÃ©thodes de lissage par noyau (Kernel Density Estimation, KDE), essentielles pour des analyses continues sans les effets du MAUP.

Waller, L. A., & Gotway, C. A. (2004). Applied Spatial Statistics for Public Health Data. Wiley, Hoboken.
    Un manuel dÃ©taillant les approches statistiques spatiales, y compris le lissage, la correction des effets de bord, et les solutions pour attÃ©nuer les biais en santÃ© publique.
```

## Techniques de RÃ©gression Spatiale et MÃ©thodes AvancÃ©es

```         
Anselin, L. (1988). Spatial Econometrics: Methods and Models. Kluwer Academic Publishers, Dordrecht.
    Ouvrage de rÃ©fÃ©rence pour les mÃ©thodes de rÃ©gression spatiale, incluant la rÃ©gression spatiale pondÃ©rÃ©e et les modÃ¨les Ã©conomÃ©triques spatiaux.

Banerjee, S., Carlin, B. P., & Gelfand, A. E. (2014). Hierarchical Modeling and Analysis for Spatial Data. Chapman & Hall/CRC.
    Exploration des modÃ¨les hiÃ©rarchiques bayÃ©siens et de leurs applications en analyses spatiales, une mÃ©thode avancÃ©e pour rÃ©duire les biais du MAUP.
```

## Sensibilisation et Prise en Compte des Effets du MAUP

```         
Dark, S. J., & Bram, D. (2007). "The Modifiable Areal Unit Problem (MAUP) in Physical Geography". Progress in Physical Geography, 31(5), 471-479.
    Article de synthÃ¨se qui explique les effets du MAUP en gÃ©ographie physique et propose des solutions mÃ©thodologiques pour sa minimisation.
```

## Techniques SpÃ©cifiques de Lissage et Estimation

```         
Diggle, P. J. (1985). "A Kernel Method for Smoothing Point Process Data". Journal of the Royal Statistical Society: Series C (Applied Statistics), 34(2), 138-147.
    Ouvrage classique sur le choix et l'impact des noyaux et de la largeur de bande (bandwidth) en lissage spatial.
```

## Approches pour Limiter les Effets du MAUP

```         
Cressie, N. (1993). Statistics for Spatial Data. Wiley, New York.
    Livre qui aborde divers problÃ¨mes spatiaux, notamment les effets de bord et les approches de pondÃ©ration spatiale pour Ã©viter les biais.

Haining, R. P. (2003). Spatial Data Analysis: Theory and Practice. Cambridge University Press.
    Aborde le MAUP et propose des techniques dâ€™analyse de sensibilitÃ© pour tester lâ€™effet des diffÃ©rentes Ã©chelles sur les donnÃ©es spatiales.
```
